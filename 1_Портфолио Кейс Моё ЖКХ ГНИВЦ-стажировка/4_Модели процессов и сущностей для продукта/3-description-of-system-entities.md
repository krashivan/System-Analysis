# 3. ОПИСАНИЕ СУЩНОСТЕЙ СИСТЕМЫ

## 3.1. Сущности предметной области 1
### 3.2.1. Логическая схема предметной области 1  

![Рисунок 1 – Логическая схема "Обращения"](../4-sprint/Diagramm/requests_logical_4.png)  
Рисунок 1 – Логическая схема "Обращения"

Таблица 1 – Описание атрибутов таблицы БД "Обращения"
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор  | + | число |
| 2 | полное имя | + | строка |
| 3 | дата рождения  | + | дата |
| 4 | логин  | + | строка  |
| 5 | пароль  | + | строка  | 
| 6 | телефон | - | строка  | 
| 7 | электронная почта  | - | строка  | 

Таблица 2 – Описание атрибутов таблицы "Addresses"
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | число | 
| 2 | город  |  + | строка  | 
| 3 | улица  |  + | строка  | 
| 4 | дом | + | число | - |
| 5 | корпус |  - | строка  | 
| 6 | квартира  |  + | число |
| 7 | тип улицы  |  + | строка  | 
| 8 | жилец  |  + | число | 

Таблица 3 – Описание атрибутов таблицы "Sessions"
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор  |  + | число |
| 2 | время запуска  |  + | дата/время | 
| 3 | продолжительность |  + | число | 
| 4 | токе  | + | строка  | - |
| 5 | жилец  | + | число | 
| 6 | менеджер компании  | + | число |

Таблица 4 – Описание атрибутов таблицы "Notifications"
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор  |  + | число | 
| 2 | источник |  + | строка  | 
| 3 | текст  |  + | строка  |
| 4 | дата отправки | + | дата/время | 
| 5 | жилец  | + | int(20) | 
| 6 | менеджер компании  | + | число | 

Таблица 5 – Описание атрибутов таблицы "Managers"
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор |  + | число | 
| 2 | полное имя   |  + | строка  | 
| 3 | телефон  | - | строка  | 
| 4 | электронная почта   |  - | строка  | 
| 5 | компания | + | число | 

Таблица 6 – Описание атрибутов таблицы "Companies"
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор |  + | число | 
| 2 | название  |  + | строка  | 
| 3 | тип компании |  + | строка  | 

Таблица 7 – Описание атрибутов таблицы "Notices"
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор  | + | число |
| 2 | тема  |  + | строка  | 
| 3 | содержание  |  + | строка  | 
| 4 | время создания  |  + | дата/время |
| 6 | адрес |  + | число | 
| 7 | компания |  + | число | 

Таблица 8 – Описание атрибутов таблицы "Ratings"
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор |  + | число |
| 2 | оценка  |  + | число | 
| 3 | комментарий |  - | строка  |
| 4 | идетификатор  |  + | число | 

Таблица 9 – Описание атрибутов таблицы "Requests"
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор |  + | число |
| 2 | время создания  |  + | дата/вермя |
| 3 | тема  |  + | строка  |
| 4 | статус  |  + | строка  |
| 5 | тип обращения |  + | строка  |
| 6 | содержание  | + | строка  |
| 7 | комментарий  | - | строка  |
| 8 | крайний срок  |  + | дата |
| 9 | Приоритет  |  + | логическая | Принимает значения "есть" или "нет" |
| 10 | адрес  |  + | число | Принимает одно из значений Addresses.Address_Id |
| 11 | исполнитель | + | число | Принимает одно из значений Worrkers.Worker_Id |
| 12 | компания  |  + | число | Принимает одно из значений Companies.Company_Id |

Таблица 10 – Описание атрибутов таблицы "Workers"
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор |  + | число |
| 2 | полное имя   |  + | строка  |
| 3 | телефон |  - | строка | Строка должна начинаться с "+" |
| 4 | специализация |  + | строка  |
| 5 | идентификатор  |  + | число |

### 3.1.2.	Физическая модель данных предметной области 1

![Рисунок 2 – Физическая модель данных "Обращения"](../4-sprint/Diagramm/requests_ER.png)  
Рисунок 2 – Физическая модель данных "Обращения"

Таблица 1 – Описание атрибутов таблицы БД "Обращения"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор  | Tenant_Id | + | int(20) | - |
| 2 | полное имя  | Full_name | + | varchar(50) | - |
| 3 | дата рождения  | Birth_date | + | date | - |
| 4 | логин  | Login | + | varchar(30) | - |
| 5 | пароль  | Password | + | varchar(50) | - |
| 6 | телефон | Phone_number | - | varchar(20) | Строка должна начинаться с "+" |
| 7 | электронная почта  | Email | - | varchar(30) | - |

Таблица 2 – Описание атрибутов таблицы "Addresses"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Address_Id | + | int(20) | - |
| 2 | город  | City | + | varchar(50) | - |
| 3 | улица  | Street | + | varchar(50) | - |
| 4 | дом | House | + | int(5) | - |
| 5 | корпус | Building | - | varchar(5) | - |
| 6 | квартира  | Apartment | + | int(7) | - |
| 7 | тип улицы  | Street_type | + | varchar(20) | - |
| 8 | жилец  | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |

Таблица 3 – Описание атрибутов таблицы "Sessions"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор  | Session_Id | + | int(20) | - |
| 2 | время запуска  | Start_time | + | timestamp | - |
| 3 | продолжительность | Life | + | int | Не может принимать отрицательное значение |
| 4 | токе  | Token | + | varchar(50) | - |
| 5 | жилец  | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |
| 6 | менеджер компании  | Manager_Id | + | int(20) | Принимает одно из значений Managers.Manager_Id |

Таблица 4 – Описание атрибутов таблицы "Notifications"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор  | Notification_Id | + | int(20) | - |
| 2 | источник | Devision | + | varchar(30) | - |
| 3 | текст  | Text | + | varchar(500) | - |
| 4 | дата отправки | Date_time | + | timestamp | - |
| 5 | жилец  | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |
| 6 | менеджер компании  | Manager_Id | + | int(20) | Принимает одно из значений Managers.Manager_Id |

Таблица 5 – Описание атрибутов таблицы "Managers"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Manager_Id | + | int(20) | - |
| 2 | полное имя   | Full_name | + | varchar(50) | - |
| 3 | телефон  | Phone_number | - | varchar(20) | Строка должна начинаться с "+" |
| 4 | электронная почта   | Email | - | varchar(30) | - |
| 5 | компания | Company_Id | + | int(20) | Принимает одно из значений Companies.Company_Id |

Таблица 6 – Описание атрибутов таблицы "Companies"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Company_Id | + | int(20) | - |
| 2 | название  | Name | + | varchar(50) | - |
| 3 | тип компании | Type | + | varchar(20) | - |

Таблица 7 – Описание атрибутов таблицы "Notices"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор  | Notice_Id | + | int(20) | - |
| 2 | тема  | Theme | + | varchar(50) | - |
| 3 | содержание  | Body | + | varchar(20) | - |
| 4 | время создания  | Created_at | + | timestamp | - |
| 6 | адрес | Address_Id | + | int(20) | Принимает одно из значений Addresses.Address_Id |
| 7 | компания | Company_Id | + | int(20) | Принимает одно из значений Companies.Company_Id |

Таблица 8 – Описание атрибутов таблицы "Ratings"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Rating_Id | + | int(20) | - |
| 2 | оценка  | Rate | + | int(5) | - |
| 3 | комментарий | Comment | - | varchar(200) | - |
| 4 | идетификатор  | Request_Id  | + | int(20) | Принимает одно из значений Requests.Request_Id |

Таблица 9 – Описание атрибутов таблицы "Requests"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Request_Id  | + | int(20) | - |
| 2 | время создания  | Created_at | + | timestamp | - |
| 3 | тема  | Them | + | varchar(20) | - |
| 4 | статус  | Status  | + | varchar(20) | - |
| 5 | тип обращения | Request_type | + | varchar(20) | - |
| 6 | содержание  | Body | + | varchar(200) | - |
| 7 | комментарий  | Comment | - | varchar(200) | - |
| 8 | крайний срок  | Expire_date  | + | date | - |
| 9 | Приоритет  | Priority | + | boolean | Принимает значения "есть" или "нет" |
| 10 | адрес  | Address_Id | + | int(20) | Принимает одно из значений Addresses.Address_Id |
| 11 | исполнитель | Worker_Id  | + | int(20) | Принимает одно из значений Worrkers.Worker_Id |
| 12 | компания  | Company_Id | + | int(20) | Принимает одно из значений Companies.Company_Id |

Таблица 10 – Описание атрибутов таблицы "Workers"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Worker_Id | + | int(20) | - |
| 2 | полное имя   | Full_name | + | varchar(50) | - |
| 3 | телефон | Phone_number | - | varchar(20) | Строка должна начинаться с "+" |
| 4 | специализация | Specialization | + | varchar(20) | - |
| 5 | идентификатор  | Company_Id | + | int(20) | Принимает одно из значений Companies.Company_Id |

### 3.1.3.	SQL-запрос для предметной области 1

### 3.1.3.1 Join
Объединение таблиц Адресов и Жильцов с фильтрацией по ID Жильца и выборкой по стобцам:

``` postgres=# select tenants.full_name, phone_number, email,
postgres-# addresses.city, street, apartment_, house, street_type, building
postgres-# from addresses
postgres-# join tenants on addresses.tenant_id=tenants.tenant_id
postgres-# where tenants.tenant_id=2;
      full_name       |   phone_number    |     email      |      city       |     street      | apartment_ | house | street_type | building
----------------------+-------------------+----------------+-----------------+-----------------+------------+-------+-------------+----------
 Фамилия Имя Отчество | +7(981) 152-15-25 | User2@mail.com | Сантк-Петербург | Федора Абрамова |       1525 |     8 | ул.         |      123
 Фамилия Имя Отчество | +7(981) 152-15-25 | User2@mail.com | Сантк-Петербург | Кондратьевский  |         45 |    70 | пр-т.       |        0
```

## 3.2.	Сущности предметной области 2
### 3.2.1.	Логическая схема предметной области 2   

![Рисунок 1 – Логическая схема предметной области 2](../4-sprint/Diagramm/invoice_logical_2.png)  
Рисунок 1 – Логическая схема предметной области 2

Таблица 1 – Описание атрибутов таблицы "Tenants"
| № п/п | Атрибут |  Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | Число |
| 2 | полное имя | + | Строка |
| 3 | дата рождения | + | Дата |
| 4 | логин | + | Строка |
| 5 | пароль | + | Строка |
| 6 | телефон | - | Строка |
| 7 | электронная почта | - | Строка |

Таблица 2 – Описание атрибутов таблицы "Addresses"
| № п/п | Атрибут |  Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | Число |
| 2 | город | + | Строка |
| 3 | улица | + | Строка |
| 4 | дом | + | Число |
| 5 | корпус | - | Строка |
| 6 | квартира | + | Число |
| 7 | Тип улицы | + | Строка |
| 8 | идентификатор жильца | + | Число |

Таблица 3 – Описание атрибутов таблицы "Sessions"
| № п/п | Атрибут |  Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | Число |
| 2 | время запуска | + | Дата и время |
| 3 | продолжительность | + | Число |
| 4 | токен | + | Строка |
| 5 | идентификатор жилец | + | Число |
| 6 | идентификатор менеджера | + | Число |

Таблица 4 – Описание атрибутов таблицы "Notifications"
| № п/п | Атрибут |  Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | Число |
| 2 | источник | + | Строка |
| 3 | текст | + | Строка |
| 4 | дата отправки | + | Дата и время |
| 5 | идентификатор жильца | + | Число |
| 6 | идентификатор менеджера | + | Число |

Таблица 5 – Описание атрибутов таблицы "Invoices"
| № п/п | Атрибут |  Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | Число |
| 2 | номер | + | Число |
| 3 | время создания | + | Дата и время |
| 4 | статус | + | Строка |
| 5 | дата истечения | + | Дата |
| 6 | сумма | + | Число |
| 7 | назначение | + | Строка |
| 8 | идентификатор жильца | + | Число |
| 9 | идентификатор менеджера | + | Число |

Таблица 6 – Описание атрибутов таблицы "Personal_account"
| № п/п | Атрибут |  Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | Число |
| 2 | номер | + | Число |
| 3 | баланс | + | Число |
| 4 | назначение | + | Строка |
| 5 | идентификатор жильца | + | Число |
| 6 | идентификатор компании | + | Число |

Таблица 7 – Описание атрибутов таблицы "Meters"
| № п/п | Атрибут |  Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | Число |
| 2 | номер | + | Число |
| 4 | тип | + | Строка |
| 4 | статус | + | Строка |
| 5 | значение | + | Число |
| 6 | идентификатор адреса | + | Число |
| 7 | идентификатор компании | + | Число |

Таблица 8 – Описание атрибутов таблицы "Managers"
| № п/п | Атрибут |  Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | Число |
| 2 | полное имя | + | Строка |
| 3 | номер телефона | - | Строка | 
| 4 | электронная почта | - | Строка |
| 5 | идентификатор компании | + | Число |

Таблица 9 – Описание атрибутов таблицы "Services"
| № п/п | Атрибут |  Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | Число |
| 2 | тип | + | Строка |
| 3 | название | + | Строка |
| 4 | описание | - | Строка |
| 5 | цена | + | Число |
| 6 | идентификатор счета | + | Число |
| 7 | идентификатор компании | + | Число | 

Таблица 10 – Описание атрибутов таблицы "Companies"
| № п/п | Атрибут |  Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | Число |
| 2 | название | + | Строка |
| 3 | тип | + | Строка |

### 3.2.2.	Физическая модель данных предметной области 2

![Рисунок 2 – Физическая модель данных предметной области 2](../4-sprint/Diagramm/physical_invoice_3.png)  
Рисунок 2 – Физическая модель данных предметной области 2

Следует привести рисунок, на котором будет представлена физическая модель данных предметной области 2.

Таблица 4 – Описание атрибутов таблицы "Tenants"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Tenant_Id | + | int(20) | - |
| 2 | полное имя | Full_name | + | varchar(50) | - |
| 3 | дата рождения | Birth_date | + | date | - |
| 4 | логин | Login | + | varchar(30) | - |
| 5 | пароль | Password | + | varchar(50) | - |
| 6 | телефон | Phone_number | - | varchar(20) | Строка должна начинаться с "+" |
| 7 | электронная почта | Email | - | varchar(30) | - |

Таблица 5 – Описание атрибутов таблицы "Addresses"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Address_Id | + | int(20) | - |
| 2 | город | City | + | varchar(50) | - |
| 3 | улица | Street | + | varchar(50) | - |
| 4 | дом | House | + | int(5) | - |
| 5 | корпус | Building | - | varchar(5) | - |
| 6 | квартира | Apartment | + | int(7) | - |
| 7 | Тип улицы | Street_type | + | varchar(20) | - |
| 8 | идентификатор жильца | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |

Таблица 6 – Описание атрибутов таблицы "Sessions"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Session_Id | + | int(20) | - |
| 2 | время запуска | Start_time | + | timestamp | - |
| 3 | продолжительность | Life | + | int | Не может принимать отрицательное значение |
| 4 | токен | Token | + | varchar(50) | - |
| 5 | идентификатор жилец | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |
| 6 | идентификатор менеджера | Manager_Id | + | int(20) | Принимает одно из значений Managers.Manager_Id |

Таблица 7 – Описание атрибутов таблицы "Notifications"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Notification_Id | + | int(20) | - |
| 2 | источник | Devision | + | varchar(30) | - |
| 3 | текст | Text | + | varchar(500) | - |
| 4 | дата отправки | Date_time | + | timestamp | - |
| 5 | идентификатор жильца | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |
| 6 | идентификатор менеджера | Manager_Id | + | int(20) | Принимает одно из значений Managers.Manager_Id |

Таблица 8 – Описание атрибутов таблицы "Invoices"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Invoice_Id | + | int(20) | - |
| 2 | номер | Number | + | int(30) | - |
| 3 | время создания | Created_at | + | timestamp | - |
| 4 | статус | Status | + | varchar(20) | - |
| 5 | дата истечения | Expire_date | + | date | Не может принимать значение, меньше текущей даты |
| 6 | сумма | Sum | + | float(10) | Не может принимать отрицательное значение |
| 7 | назначение | Assignment | + | varchar(20) | - |
| 8 | идентификатор жильца | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |
| 9 | идентификатор менеджера | Manager_Id | + | int(20) | Принимает одно из значений Managers.Manager_Id |

Таблица 9 – Описание атрибутов таблицы "Personal_account"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Account_Id | + | int(20) | - |
| 2 | номер | Number | + | int(30) | - |
| 4 | баланс | Balance | + | float(10) | Не может принимать отрицательное значение |
| 4 | назначение | Assignment | + | varchar(20) | - |
| 5 | идентификатор жильца | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |
| 6 | идентификатор компании | Company_Id | + | int(20) | Принимает одно из значений Companies.Company_Id |

Таблица 10 – Описание атрибутов таблицы "Meters"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Meter_Id | + | int(20) | - |
| 2 | номер | Number | + | int(30) | - |
| 3 | тип | Type | + | varchar(20) | - |
| 4 | статус | Status | + | varchar(20) | - |
| 5 | значение | Value | + | int(20) | - |
| 6 | идентификатор адреса | Address_Id | + | int(20) | Принимает одно из значений Addresses.Address_Id |
| 7 | идентификатор компании | Company_Id | + | int(20) | Принимает одно из значений Companies.Company_Id |

Таблица 11 – Описание атрибутов таблицы "Managers"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Manager_Id | + | int(20) | - |
| 2 | полное имя | Full_name | + | varchar(50) | - |
| 3 | номер телефона | Phone_number | - | varchar(20) | Строка должна начинаться с "+" |
| 4 | электронная почта | Email | - | varchar(30) | - |
| 5 | идентификатор компании | Company_Id | + | int(20) | Принимает одно из значений Companies.Company_Id |

Таблица 12 – Описание атрибутов таблицы "Services"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Service_Id | + | int(20) | - |
| 2 | тип | Type | + | varchar(20) | - |
| 3 | название | Name | + | varchar(50) | - |
| 4 | описание | Description | - | varchar(500) | - |
| 5 | цена | Price | + | float(10) | Не может принимать отрицательное значение |
| 6 | идентификатор счета | Invoice_Id | + | int(20) | Принимает одно из значений Invoices.Invoice_Id |
| 7 | идентификатор компании | Company_Id | + | int(20) | Принимает одно из значений Companies.Company_Id |

Таблица 13 – Описание атрибутов таблицы "Companies"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Company_Id | + | int(20) | - |
| 2 | название | Name | + | varchar(50) | - |
| 3 | тип | Type | + | varchar(20) | - |

### 3.2.3.	SQL-запрос для предметной области 2  
  
 Выборка счетов конкретного жильца со спецификацией по услугам
```sql
SELECT i.invoice_id, i.number, i.expire_date, s.name, s.price, i.sum, i.status
FROM invoices i
JOIN services s ON i.invoice_id = s.invoice_id
WHERE i.tenant_id = 100
```
Баланс жильца во всех его компаниях
```sql
SELECT p.balance, c.name
FROM personal_account p
JOIN companies c ON p.company_id = c.company_id
WHERE p.tenant_id = 100
```
Счетчики и их показания по данному адресу
```sql
SELECT a.address_id,m.company_id, m.meter_id, m.value
FROM adress a
JOIN addresses_meters am ON a.address_id = am.address_id
JOIN meters m ON am.meter_id = m.meter_id
WHERE a.address_id = 1230
```

## 3.3.	Сущности предметной области 3
### 3.3.1.	Логическая схема предметной области 3  

![Рисунок 1 – Логическая схема предметной области 3](../4-sprint/Diagramm/events_logical_1.png)  
Рисунок 1 – Логическая схема предметной области 3

Следует привести рисунок, на котором будет представлена логическая схема предметной области 3.

Таблица 4 – Описание атрибутов сущности предметной области 3
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор  |  + | число |
| 2 | полное имя  | +  |  строка |
| 3 | дата рождения  | +  | дата  |
| 4 | логин  |  + | строка  |
| 5 | пароль  | +  | строка  |
| 6 | телефон | -  | строка  |
| 7 | электронная почта | -  |  строка |

Таблица 5 – Описание атрибутов сущности предметной области 3
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | число |
| 2 | город | + | строка |
| 3 | улица | + | строка |
| 4 | дом | + | число |
| 5 | корпус | - | строка |
| 6 | квартира | Apa+rtment | число |
| 7 | Тип улицы | + | строка |
| 8 | идентификатор жильца | + | число |

Таблица 6 – Описание атрибутов сущности предметной области 3
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | число |
| 2 | время запуска | + | дата/время |
| 3 | продолжительность | + | число |
| 4 | токен | + | строка) |
| 5 | идентификатор жилец | + | число | 
| 6 | идентификатор менеджера | + | число |

Таблица 7 – Описание атрибутов сущности предметной области 3
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | число |
| 2 | источник | + | строка |
| 3 | текст | + | строка |
| 4 | дата отправки | + | дата/время |
| 5 | идентификатор жильца | + | число |
| 6 | идентификатор менеджера | + | число |

Таблица 8 – Описание атрибутов сущности предметной области 3
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | число |
| 2 | полное имя | + | строка |
| 3 | номер телефона | - | строка |
| 4 | электронная почта | - | строка |
| 5 | идентификатор компании | + | число |

Таблица 9 – Описание атрибутов сущности предметной области 3
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор | + | число |
| 2 | название | + | строка |
| 3 | описание | - | строка |
| 4 | дата | + | дата |

Таблица 10 – Описание атрибутов сущности предметной области 3
| № п/п | Атрибут | Обязательность | Тип данных |
|----|----|----|----|
| 1 | идентификатор события | + | число |
| 2 | идентификатор адреса | + | число |

### 3.3.2.	Физическая модель данных предметной области 3

![Рисунок 2 – Физическая модель данных предметной области 3](../4-sprint/Diagramm/Events_ER_new.png)  
Рисунок 2 – Физическая модель данных предметной области 3

Следует привести рисунок, на котором будет представлена физическая модель данных предметной области 3.

Таблица 4 – Описание атрибутов таблицы "Tenants"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Tenant_Id | + | int(20) | - |
| 2 | полное имя | Full_name | + | varchar(50) | - |
| 3 | дата рождения | Birth_date | + | date | - |
| 4 | логин | Login | + | varchar(30) | - |
| 5 | пароль | Password | + | varchar(50) | - |
| 6 | телефон | Phone_number | - | varchar(20) | Строка должна начинаться с "+" |
| 7 | электронная почта | Email | - | varchar(30) | - |

Таблица 5 – Описание атрибутов таблицы "Addresses"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Address_Id | + | int(20) | - |
| 2 | город | City | + | varchar(50) | - |
| 3 | улица | Street | + | varchar(50) | - |
| 4 | дом | House | + | int(5) | - |
| 5 | корпус | Building | - | varchar(5) | - |
| 6 | квартира | Apartment | + | int(7) | - |
| 7 | Тип улицы | Street_type | + | varchar(20) | - |
| 8 | идентификатор жильца | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |

Таблица 6 – Описание атрибутов таблицы "Sessions"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Session_Id | + | int(20) | - |
| 2 | время запуска | Start_time | + | timestamp | - |
| 3 | продолжительность | Life | + | int | Не может принимать отрицательное значение |
| 4 | токен | Token | + | varchar(50) | - |
| 5 | идентификатор жилец | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |
| 6 | идентификатор менеджера | Manager_Id | + | int(20) | Принимает одно из значений Managers.Manager_Id |

Таблица 7 – Описание атрибутов таблицы "Notifications"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Notification_Id | + | int(20) | - |
| 2 | источник | Devision | + | varchar(30) | - |
| 3 | текст | Text | + | varchar(500) | - |
| 4 | дата отправки | Date_time | + | timestamp | - |
| 5 | идентификатор жильца | Tenant_Id | + | int(20) | Принимает одно из значений Tenants.Tenant_Id |
| 6 | идентификатор менеджера | Manager_Id | + | int(20) | Принимает одно из значений Managers.Manager_Id |

Таблица 8 – Описание атрибутов таблицы "Managers"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Manager_Id | + | int(20) | - |
| 2 | полное имя | Full_name | + | varchar(50) | - |
| 3 | номер телефона | Phone_number | - | varchar(20) | Строка должна начинаться с "+" |
| 4 | электронная почта | Email | - | varchar(30) | - |
| 5 | идентификатор компании | Company_Id | + | int(20) | Принимает одно из значений Companies.Company_Id |

Таблица 9 – Описание атрибутов таблицы "Events"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор | Event_Id | + | int(20) | - |
| 2 | название | Name | + | varchar(50) | - |
| 3 | описание | Description | - | varchar(500) | - |
| 4 | дата | Date | + | date | - |

Таблица 10 – Описание атрибутов таблицы "Events_addresses"
| № п/п | Атрибут | Наименование в БД | Обязательность | Тип данных в БД и длина | Комментарии, правила валидации |
|----|----|----|----|----|----|
| 1 | идентификатор события | Event_Id | + | int(20) | - |
| 2 | идентификатор адреса | Address_Id | + | int(20) | - |

### 3.3.3.	SQL-запрос для предметной области 3

Получить список приборов учета:
```sql
SELECT * FROM meters
```

Получить список новых заявок:
```sql
SELECT * FROM requests WHERE status = 'Создан'
```

Получить информацию о конкретной заявке:
```sql
SELECT * FROM requests WHERE request_id = 1
```

Получить тарифы за услуги:
```sql
SELECT service_id, name, price FROM services
```

Получить список неоплаченных счетов за услуги:
```sql
SELECT * FROM invoices where status != 'Оплачено'
```
